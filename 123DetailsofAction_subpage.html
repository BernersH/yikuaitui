<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>活动详情</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" type="text/css" href="css/mui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/app.css" />
		<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/url.js" type="text/javascript" charset="utf-8"></script>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
	</head>

	<body style="padding-bottom:0 ;">
		<div class="mui-content" style="margin-top: 14px;">
			<div class="picofworks" id="sliderContent">
				<div id="slider" class="mui-slider">
					<div class="mui-slider-group mui-slider-loop" id="lunbo">
						<div class="mui-slider-item">
							<a href="#"><img src=></a>
						</div>
						

					</div>
					<div class="mui-slider-indicator" id="dotcontent">

					</div>
				</div>

			</div>

			<div class="personofworks">
				<div class="user"> <span id="portrait">
                	    	<img src="UI/yqt/icon/1(1).png" id = "icon"/>
                	    </span>
					<span id="user_name">
	     	            	 
	     	            </span>
				</div>

				<div class="feelactive"> <img src="UI/yqt/icon/主页-赞.png" class="icon" />
					<span id="numoflike">
						
	     	            </span>
					<img src=" UI/yqt/icon/主页-踩.png" class="icon" />
					<span id="numofunlike">
	     	            </span>
					<img src="UI/yqt/icon/主页-评论.png" class="icon" />
					<span id="numofcomment">
	     	            </span>
					<img src="UI/yqt/icon/主页-分享.png" class="icon" />
					<span id="numoftrans">
	     	            </span>
				</div>
			</div>
			<div class="numofperson">
				已报名人数：<span id="numofperson"> </span>人
			</div>
			<div class="title">
				<div class="title-left">

					<p id="title">属于你我的风光 </p>
					<p style="color: white;font-size: 21px;margin-top: -6px;">——<span id="title-place">普吉岛</span></p>
				</div>
				<div class="title-right">
					<div>

						<input type="button" id="showmask" value="我要报名" />
					</div>

					<div>

						<p style="font-size: 10px;margin-left: -13%;">发布时间：<span id="time">
	     	    	   2015-7-5
	     	    </span></p>
					</div>
				</div>
			</div>
			<div class="line1" style="margin-top:30px;"> </div>
			<div class="theme">1.活动主题:<span id="theme">属于你我的风光</span></div>
			<div class="timeofaction">2.活动时间:<span id="timeofaction">2015.09.03</span></div>
			<div class="line1"> </div>
			<ul style="margin-top: 20px;margin-bottom: 30px;" id='ulofpinglun'>
				<li class="user1">
					<div name="comment" class="textarea1">求指教！</div>
					<div class="person"><img src="UI/yqt/icon/1(1).png" />
						<p id="commentuser_name">我</p>
					</div>
					<span class="floor">
	     	    	<span id="numoffloor">
	     	    		1
	     	    	</span>楼
					<span id="time2">
	     	         	2015-7-4
	     	         </span>
					</span>
					<div class="clear"> </div>
				</li>
			</ul>

			<div class="line"> </div>
			<div class="signup">报名列表</div>
			<div class="signuplist">
				<ul>
					<li class="list">
						<div class="up"><span id="numofsignup">4.</span><img src="UI/yqt/icon/1(1).png" id="portrait1" /><span id="nickname">Steven Smith</span>
							<span id="active">
           <img src="UI/yqt/icon/太阳.png"/>			
		  <img src="UI/yqt/icon/太阳.png"/>	
		<img src="UI/yqt/icon/太阳.png"/>	
		</span>
						</div>
						<div class="down">姓名：<span id="name" style="margin-right: 15px;">史蒂芬.史密斯</span>
						</div>
					</li>
					<li class="list">
						<div class="up"><span id="numofsignup">3.</span><img src="UI/yqt/icon/1(1).png" id="portrait1" /><span id="nickname">Steven Smith</span>
							<span id="active">
           <img src="UI/yqt/icon/太阳.png"/>			
		  <img src="UI/yqt/icon/太阳.png"/>	
		<img src="UI/yqt/icon/太阳.png"/>	
		</span>
						</div>
						<div class="down">姓名：<span id="name" style="margin-right: 15px;">史蒂芬.史密斯</span>
						</div>
					</li>
					<li class="list">
						<div class="up"><span id="numofsignup">2.</span><img src="UI/yqt/icon/1(1).png" id="portrait1" /><span id="nickname">Steven Smith</span>
							<span id="active">
           <img src="UI/yqt/icon/太阳.png"/>			
		  <img src="UI/yqt/icon/太阳.png"/>	
		<img src="UI/yqt/icon/太阳.png"/>	
		</span>
						</div>
						<div class="down">姓名：<span id="name" style="margin-right: 15px;">史蒂芬.史密斯</span>
						</div>
					</li>
					<li class="list">
						<div class="up"><span id="numofsignup">1.</span><img src="UI/yqt/icon/1(1).png" id="portrait1" />
							<span id="nickname">Steven Smith</span>
							<span id="active">
					           <img src="UI/yqt/icon/太阳.png"/>			
							  <img src="UI/yqt/icon/太阳.png"/>	
							<img src="UI/yqt/icon/太阳.png"/>	
							</span>
						</div>
						<div class="down">姓名：<span id="name" style="margin-right: 15px;">史蒂芬.史密斯</span>
						</div>
					</li>

				</ul>
			</div>
		</div>

		<div class="mask" id="mask"> </div>
		<div class="maskflow" id="maskflow">
			<div class="header1">我要报名</div>
			<div class="divofname">
				<label for="username">1.本人姓名</label>
				<input type="text" name="" id="username" value="" />
			</div>
			<div class="divoftel">
				<label for="tel">2.联系方式</label>
				<input type="tel" name="" id="tel" value="" />
			</div>
			<div class="timeofsignup">报名时间<span id="timeofsignup">2015.07.05~08.30</span></div>
			<div class="besure" id="besure">确定</div>
		</div>

		<div class="pinglunfooter">
			<input type="text" name="comment" id="comment" value="" placeholder="我也说两句（不超过48个字）" />
			<label for="comment">
				<div class="imgcomment"><img src="UI/yqt/icon/评论（大）.png" /></div>
			</label>
		</div>

	</body>

</html>
<script type="text/javascript">
	var urls = surl + "project/getDetail";
	var jsonobj = {
		'type': 'active',
		'tuiId': 1
	};
	mui.ajax(urls, {
		data: jsonobj,
		dataType: 'json',
		type: 'post',
		timeout: 10000,
		success: function(data) {
			if (data.state !== '1') {
				var place = data.place;
				var act_time = data.act_time;
				var theme = data.theme;
				var comm = data.comment;
				var icon = data.icon;
				var buildId = data.id;
				var id = data.loginId; //ID
				var joined_number = data.joined_num;
				var prise = data.praise;
				var repost = data.repost;
				var roast = data.roast;
				var status = data.status;
				var upload = data.upload;
				var splitupload = upload.split("\"");
				var newimsrc = serip + splitupload[1];
				var userid = data.userId;
				var username = data.username;
				var longtime = data.time;
				var spliTime = longtime.split(" ");
				var time = spliTime[0];
				var usefulpic = new Array();
				var div = new Array();
				var diver = "";
				var jj = 0;
				var commentlist = new Array();
				var com = new Array(); //评论
				var floor = new Array(); //楼层
				var comTime = new Array(); //评论时间
				var commId = new Array(); //评论人的ID
				var commUserName = new Array(); // 评论者的昵称
				var commIcon = new Array();
				var commentlist = data.commentList;
				var commentdiv = "";
				var commentplace = document.getElementById("ulofpinglun");
				var li = new Array();
				for (q = 0; q < commentlist.length; q++) {
					com[q] = commentlist[q].comment;
					floor[q] = commentlist[q].floor;
					comTime[q] = commentlist[q].time;
					commUserName[q] = commentlist[q].username;
					commId[q] = commentlist[q].userId;
					commIcon[q] = commentlist[q].icon; //评论人的头像
					if (id == commId[q]) {
						li[q] = "<li class=\"user1\"><div name=\"comment\" class=\"textarea1\">" + com[q] + "</div>";
						li[q] += "<div class=\"person\"><img src=\"" + serip + commIcon[q] + "\" />";
						li[q] += "<p id=\"commentuser_name\">我</p></div>";
						li[q] += "<span class=\"floor\"><span id=\"numoffloor\">" + floor[q] + "</span>楼";
						li[q] += "<span id=\"time2\">" + comTime[q] + "</span></span>";
						li[q] += "<div class=\"clear\"></div></li>";
						commentdiv += li[q];
						commentplace.innerHTML = commentdiv;
					}
					if (id != commId[q]) {
						li[q] = "<li class=\"user2\"><div class=\"person\"><img src= \"" + serip + commIcon[q] + "\"/>";
						li[q] += "<p id=\"user_name\">" + commUserName[q] + "</p></div>";
						li[q] += "<div name=\"comment\" class=\"textarea\">" + com[q] + "</div>";
						li[q] += "<span class=\"floor\"><span id=\"numoffloor\">" + floor[q] + "</span>楼";
						li[q] += "<span id=\"time2\">" + comTime[q] + "</span></span>";
						li[q] += "<div class=\"clear\"></div></li>";
						commentdiv += li[q];
						commentplace.innerHTML = commentdiv;
					}
				}
				for (y = 0; y < splitupload.length; y++) {
					if (y % 2 != 0) {
						usefulpic[jj] = splitupload[y];
						jj++;
					}
				}
				document.getElementById("numoflike").innerHTML = prise;
				document.getElementById("user_name").innerHTML = username;
				document.getElementById("numofunlike").innerHTML = roast;
				document.getElementById("numofcomment").innerHTML = comm;
				document.getElementById("numoftrans").innerHTML = data.repost;
				document.getElementById("numofperson").innerHTML = joined_number;
				document.getElementById("title").innerHTML = theme;
				document.getElementById("title-place").innerHTML = place;
				document.getElementById("time").innerHTML = time;
				document.getElementById("timeofaction").innerHTML = act_time;
				//				document.getElementById("imgfirst").src = serip + usefulpic[0];
				document.getElementById("icon").src = serip + icon;
				//				document.getElementById("imglast").src = serip + usefulpic[usefulpic.length - 1];
				var divinner = "";
				var dotinner = "";
				var newdiv = new Array();
				var divlun = document.createElement("div");
				var dot = new Array();
				divlun.setAttribute('class', "mui-slider-group mui-slider-loop");
				for (i = 0; i < (usefulpic.length + 2); i++) {
					newdiv[i] = "";
					if (i == 0) {
						newdiv[i] += "<div class=\"mui-slider-item\"><a href=\"#\">";
						//						newdiv[i] += "<img src=\""+serip+usefulpic[usefulpic.length-1]+"\"></a></div>";
						newdiv[i] += "<img src=\"" + serip + splitupload[usefulpic.length - 1] + "\"></a></div>";
					} else if (i == (usefulpic.length + 1)) {
						newdiv[i] += "<div class=\"mui-slider-item\"><a href=\"#\">";
						//						newdiv[i] += "<img src=\""+serip+usefulpic[0]+"\"></a></div>";
						newdiv[i] += "<img src=\"" + serip + usefulpic[0] + "\"></a></div>";
					} else {
						newdiv[i] += "<div class=\"mui-slider-item\"><a href=\"#\">";
						newdiv[i] += "<img src=\"" + serip + usefulpic[i - 1] + "\"></a></div>";
					}
					divinner += newdiv[i];
				}
				for (i = 0; i < usefulpic.length; i++) {
					dot[i] = "";
					if (i == 0) {
						dot[i] += "<div class=\"mui-indicator mui-active\"></div>";
					} else {
						dot[i] += "<div class=\"mui-indicator\"></div>";
					}
					dotinner += dot[i];
				}
				
				localStorage.imgdiv = divinner;
				localStorage.imgdot = dotinner;
				document.getElementById("lunbo").innerHTML = localStorage.imgdiv;
				document.getElementById("dotcontent").innerHTML = localStorage.imgdot;
				localStorage.imgdiv = "";
				localStorage.imgdot = "";
				
			}
		},
		error: function(XMLHttpRequest, xmlhttp, errorThrown, data) {
			mui.toast("网络连接错误");
			console.log("XMLHttpRequest.readyState:" + XMLHttpRequest.readyState);
			console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
			return false;
		}
	})
	var likenum = document.getElementById("numoflike");
	var showmask = document.getElementById("showmask");
	var mask = document.getElementById("mask");
	var besure = document.getElementById("besure");

	function showMask() {
		$("#mask").css("height", $(document).height());
		$("#mask").css("width", $(document).width());
		$("#mask").show();
		showMaskFlow();
	}

	function showMaskFlow() {
		var showflow = document.getElementById("maskflow");
		showflow.style.display = 'block';
	}

	function hideMaskFlow() {
		var showflow = document.getElementById("maskflow");
		showflow.style.display = 'none';
	}

	function hideMask() {
		hideMaskFlow();
		$("#mask").hide();
	}
	showmask.addEventListener('touchstart', function() {
		showMask();
	})
	besure.addEventListener('touchstart', function() {
		hideMask();
	})
	mask.addEventListener('touchstart', function() {
		hideMask();
	})
	var slider = document.getElementById("slider");
	slider.slider({
		interval: 5000
	});
</script>