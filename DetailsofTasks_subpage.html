<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>任务详情</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" type="text/css" href="css/mui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/app.css" />
		<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/ajax.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/url.js" type="text/javascript" charset="utf-8"></script>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="js/TouchSlide.1.1.js" ></script>
<style>
		/* bannercss -------------------------------------- */

.focus {
	width: 100%;
	height: 7rem;
	margin: 0 auto;
	position: relative;
	overflow: hidden;
}
.focus .hd {
	width: 100%;
	height: 0.35rem;
	position: absolute;
	z-index: 1;
	bottom: 0.35rem;
	text-align: center;
	background:rgba(255,255,255,0);
}
.focus .hd ul {
	display: inline-block;
	height: 0.35rem;
	padding: 0px;
	-webkit-border-radius: 0.35rem;
	-moz-border-radius: 0.35rem;
	border-radius: 0.35rem;
	font-size: 0;
	vertical-align: top;
}
.focus .hd ul li {
	display: inline-block;
	width: 0.35rem;
	height: 0.35rem;
	-webkit-border-radius: 0.35rem;
	-moz-border-radius: 0.35rem;
	border-radius: 0.35rem;
	background: #fff;
	margin: 0 0.35rem;
	vertical-align: top;
	overflow: hidden;
}
.focus .hd ul .on {
	background: #cc002c;
}
.focus .bd {
	position: relative;
	z-index: 0;
}
.focus .bd li img {
	width: 100%;
	height: 7rem;
	background: url(images/loading.gif) center center no-repeat;
}
.focus .bd li a {
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	/* 取消链接高亮 */
}
.banner {
	width: 100%;
	padding: 0px;
}
/*banner结束*/
</style>
	</head>

	<body style="padding-bottom:0 ;">
		<div class="mui-content" style="margin-top: 14px;">
			 <!-- banner Start ================================ -->
  <div id="focus" class="focus">
    <div class="hd">
      <ul >
     
      </ul>
    </div>
    <div class="bd">
      <ul class="bdul">
       
      </ul>
    </div>
  </div>
 
  <!-- banner End ================================ --> 
			
			
		<!--
        
        	<div class="picofworks" id="sliderContent">
				<div id="slider" class="mui-slider">
					<div class="mui-slider-group mui-slider-loop" id="lunbo">
						<div class="mui-slider-item">
							<a href="#"><img src=></a>
						</div>
					</div>
					<div class="mui-slider-indicator" id="dotcontent">

					</div>
				</div>

			</div>-->
			<div class="personofworks">
				<div class="user" id="taren"> <span id="portrait">
                	    	<img src="" id="icon"/>
                	    </span>
					<span id="user_name">
	     	            	
	     	            </span>
				</div>
				<div class="feelactive">
					<img src="Myicon/zan.png" class="icon" id="numoflikepic" />
					<span id="numoflike">
						
	     	            </span>
					<img src="Myicon/tread icon.png" class="icon" id="numofunlikepic" />
					<span id="numofunlike">
	     	          
					    </span>
					<img src="Myicon/pinglun.png" class="icon" />
					<span id="numofcomment">
	     	            </span>
					<img src="Myicon/share icon.png" class="icon" />
					<span id="numoftrans">
	     	            </span>
				</div>
			</div>
			<div class="juli" style="margin-bottom: -20px;">距离：<span id="juli"></span></div>
			<div class="title">
				<div class="title-left">

					<p id="title"> </p>
					<p style="color: white;font-size: 21px;margin-top: -6px;">——<span id="title-place"></span></p>
				</div>
				<div class="title-right">
					<div style="color: #D84A70;font-size: 24px;">
						¥<span id="money"> </span>
					</div>

					<div>

						<p style="font-size: 10px;margin-left: -%;">发布时间：<span id="time">
	     	    	   
	     	    </span></p>
					</div>
				</div>
			</div>

			<div class="line1" style="margin-top: 30px;"> </div>
			<div class="describe" id="describe">

			</div>
			<div class="line1"> </div>

			<ul style="margin-top: 20px;margin-bottom: 65px;" id='ulofpinglun'>

			</ul>
			<div class="picofpinglun" style="text-align: center;height: 100%;margin-top:-20px ;">
				<img src="Myicon/comment.png" style="width: 12%;" id="picofpinglun" />
			</div>
		</div>

	</body>

</html>
<script type="text/javascript">
	var userid = '';
	var urls = surl + "project/getDetail";
	var jsonobj = {
		'type': 'requirement',
		'tuiId': localStorage.gettuiId
	};
	mui.ajax(urls, {
		data: jsonobj,
		dataType: 'json',
		type: 'post',
		timeout: 10000,
		success: function(data) {
			var icon = data.icon;
			var username = data.username;
			var theme = data.theme;
			var comments = data.comment;
			var upload = data.upload;
			var splitupload = upload.split("\"");
			var newimsrc = serip + splitupload[1];
			var demand = data.demand;
			var distance = data.distance;
			var money = data.money;
			userid = data.userId;
			var ifPraised = data.isPraised;
			var ifRoast = data.isRoast;
			if (ifPraised == '1') {
				document.getElementById("numoflikepic").src = 'Myicon/zan2.png';
			} else {
				document.getElementById("numoflikepic").src = 'Myicon/zan.png';
			}
			if (ifRoast == '1') {
				document.getElementById("numofunlikepic").src = 'Myicon/tucao2.png'
			} else {
				document.getElementById("numofunlikepic").src = 'Myicon/tread icon.png'
			}
			var id = data.loginId;
			var prise = data.praise;
			var repost = data.repost;
			var roast = data.roast;
			var jj = 0;
			var time = data.time;
			var place = data.place;
			var content = data.content;
			var usefulpic = new Array();
			var com = new Array(); //评论
			var floor = new Array(); //楼层
			var comTime = new Array(); //评论时间
			var commId = new Array(); //评论人的ID
			var commUserName = new Array(); // 评论者的昵称
			var commIcon = new Array();
			var commentlist = new Array;
			var commentlist = data.commentList;
			var commentdiv = "";
			var portrait = document.getElementById("portrait")
			document.getElementById("juli").innerHTML = distance;
			document.getElementById("user_name").innerText = username;
			document.getElementById("numoflike").innerText = prise;
			document.getElementById("numofunlike").innerText = roast;
			document.getElementById("numofcomment").innerText = comments;
			document.getElementById("numoftrans").innerText = repost;
			document.getElementById("title").innerText = theme;
			document.getElementById("title-place").innerText = demand;
			document.getElementById("money").innerText = money;
			document.getElementById("time").innerText = time;
			document.getElementById("describe").innerText = content;
			document.getElementById("icon").src = serip + icon;
			var commentplace = document.getElementById("ulofpinglun");
			var li = new Array();
			for (q = 0; q < commentlist.length; q++) {
				com[q] = commentlist[q].comment;
				floor[q] = commentlist[q].floor;
				comTime[q] = commentlist[q].time;
				commUserName[q] = commentlist[q].username;
				commId[q] = commentlist[q].userId;
				commIcon[q] = commentlist[q].icon; //评论人的头像
				if (id == commId[q]) {
					li[q] = "<li class=\"user1\"><div name=\"comment\" class=\"textarea1\">" + com[q] + "</div>";
					li[q] += "<div class=\"person\"><img src=\"" + serip + commIcon[q] + "\" />";
					li[q] += "<p id=\"commentuser_name\">我</p></div>";
					li[q] += "<span class=\"floor\"><span id=\"numoffloor\">" + floor[q] + "</span>楼";
					li[q] += "<span id=\"time2\">" + comTime[q] + "</span></span>";
					li[q] += "<div class=\"clear\"></div></li>";
					commentdiv += li[q];
					commentplace.innerHTML = commentdiv;
				}
				if (id != commId[q]) {
					li[q] = "<li class=\"user2\"><div class=\"person\"><img src= \"" + serip + commIcon[q] + "\"/>";
					li[q] += "<p id=\"user_name\">" + commUserName[q] + "</p></div>";
					li[q] += "<div name=\"comment\" class=\"textarea\">" + com[q] + "</div>";
					li[q] += "<span class=\"floor\"><span id=\"numoffloor\">" + floor[q] + "</span>楼";
					li[q] += "<span id=\"time2\">" + comTime[q] + "</span></span>";
					li[q] += "<div class=\"clear\"></div></li>";
					commentdiv += li[q];
					commentplace.innerHTML = commentdiv;
				}
			}
			for (y = 0; y < splitupload.length; y++) {
				if (y % 2 != 0) {
					usefulpic[jj] = splitupload[y];
					jj++;
				}
			}
	
		var divinner = "";
				var dotinner = "";
				var newdiv = new Array();
				var dot = new Array();
//				       <li class="bdulli"><a href="http://www.tudou.com"><img _src="Myicon/2.jpg" src="images/blank.png" /></a></li>
                var bd = document.getElementById("focus");
                var bdul = bd.childNodes[3].childNodes[1].firstChild;
                var bdulinner = "";
               
                for (i = 0; i < usefulpic.length; i++){
//              	if(i%2==1){
                	bdulinner += "<li class=\"bdulli\"><a href=\"#\"><img _src=\""+serip+usefulpic[i]+"\" src=\"images/blank.png\" /></a></li>"; 
//              }
                	}

                bdul.innerHTML = bdulinner;
                
                     (function (doc, win) {
          var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
              var clientWidth = docEl.clientWidth;
              if (!clientWidth) return;
              docEl.style.fontSize = 20 * (clientWidth / 320) + 'px';
            };

          if (!doc.addEventListener) return;
          win.addEventListener(resizeEvt, recalc, false);
          doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);
				TouchSlide({ 
					slideCell:"#focus",
					titCell:".hd ul", //开启自动分页 autoPage:true ，此时设置 titCell 为导航元素包裹层
					mainCell:".bd ul", 
					effect:"left", 
				  interTime:"5000",//切换时间
					autoPlay:true,//自动播放
					autoPage:true, //自动分页
					switchLoad:"_src" //切换加载，真实图片路径为"_src" 
				});
			
		
		},
		error: function(XMLHttpRequest, xmlhttp, errorThrown, data) {
			mui.toast("网络连接错误");
			console.log("XMLHttpRequest.readyState.login:" + XMLHttpRequest.readyState);
			console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
			return false;
		}
	})
	var wodelikepic = document.getElementById("numoflikepic");
	var wodelike = document.getElementById("numoflike");
	wodelikepic.addEventListener('tap', function() {
		var jsonobj = {
			"proId": localStorage.gettuiId,
			"table": 'require',
			'type': '1',
		};
		var str = jsonobj;
		var url = surl + "/user/addHot";
		mui.ajax(url, {
			data: str,
			dataType: 'json',
			type: 'post',
			timeout: 10000,
			success: function(data) {
				if (data.state == '1') {
					numoflike.innerHTML = parseInt(numoflike.innerHTML) + 1;
				    wodelikepic.src = "Myicon/zan2.png";
				} else if (data.state == '0') {
					mui.toast('对不起，今天已经点过啦~')
				}
			},
			error: function(XMLHttpRequest, xmlhttp, errorThrown, data) {
				mui.toast("网络连接错误");
				console.log("XMLHttpRequest.readyState.login:" + XMLHttpRequest.readyState);
				console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
				return false;
			}
		})
	})
	var wodeunlikepic = document.getElementById("numofunlikepic");
	var wodeunlike = document.getElementById("numofunlike");
	wodeunlikepic.addEventListener('tap', function() {
		var jsonobj = {
			"proId": localStorage.gettuiId,
			"table": 'require',
			'type': '0',
		};
		var str = jsonobj;
		var url = surl + "/user/addHot";
		mui.ajax(url, {
			data: str,
			dataType: 'json',
			type: 'post',
			timeout: 10000,
			success: function(data) {
				if (data.state == '1') {
					wodeunlike.innerHTML = parseInt(wodeunlike.innerHTML) + 1;
				     wodeunlikepic.src = 'Myicon/tucao2.png';
				} else if (data.state == '0') {
					mui.toast('对不起，今天已经点过啦~')
				}
			},
			error: function(XMLHttpRequest, xmlhttp, errorThrown, data) {
				mui.toast("网络连接错误");
				console.log("XMLHttpRequest.readyState.login:" + XMLHttpRequest.readyState);
				console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
				return false;
			}
		})
	})
	var taren = document.getElementById("taren");
	taren.addEventListener('tap', function() {
		var jsonobj = {
			'userId': userid
		};
		alert(userid);
		var str = jsonobj;
		var url = surl + "/user/getHeCenter";
		mui.ajax(url, {
			data: str,
			dataType: 'json',
			type: 'post',
			timeout: 10000,
			success: function(data) {
				localStorage.tarenid = '';
				localStorage.tarenid = userid;
				mui.openWindow({
					url: 'OthersCenter.html',
					id: 'OthersCenter.html'
				})
			},
			error: function(XMLHttpRequest, xmlhttp, errorThrown, data) {
				mui.toast("网络连接错误");
				console.log("XMLHttpRequest.readyState.login:" + XMLHttpRequest.readyState);
				console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
				return false;
			}
		})
	})
	var picofpinglun = document.getElementById("picofpinglun");
	picofpinglun.addEventListener('tap', function() {
		mui.openWindow({
			url: 'pinglunTask.html',
			id: 'pinglunTask.html'
		})
	})
</script>